package order.dao;

import java.util.ArrayList;
import java.util.List;

import order.entity.Order;
import order.entity.Product;
import order.entity.ShoppingCart;
import java.util.Optional;
public class OrderDAO {

	private static ArrayList<Order> orders = new ArrayList<>();

	public OrderDAO() {

	}

	static {
		// Creating sample products
		Product product1 = new Product("Laptop", 999.99, 2, "High-performance laptop");
		Product product2 = new Product("Mouse", 19.99, 5, "Wireless mouse");

		// Creating a shopping cart
		ArrayList<Product> productsInCart = new ArrayList<>();
		productsInCart.add(product1);
		productsInCart.add(product2);

		ShoppingCart shoppingCart = new ShoppingCart(productsInCart);

		// Creating an order with a sample orderId
		String sampleOrderId = "123456"; // You should use a unique identifier here
		Order order = new Order(sampleOrderId, shoppingCart.getProducts(), shoppingCart.calculateTotal(), "John Doe");
		orders.add(order);
	}

	public static ArrayList<Order> getAllOrders() {
		return orders;
	}

	public static boolean updateOrder(Order updatedOrder) {
		for (Order order : orders) {
			if (order.equals(updatedOrder)) {
				// Update order details
				order.setProducts(updatedOrder.getProducts());
				order.setTotalPrice(updatedOrder.getTotalPrice());
				order.setCustomerName(updatedOrder.getCustomerName());
				return true; // Successfully updated
			}
		}
		return false; // Order not found
	}

	public static boolean patchOrder(Order partialOrder) {
		Optional<Order> existingOrder = orders.stream()
				.filter(order -> order.getOrderId().equals(partialOrder.getOrderId())).findFirst();

		if (existingOrder.isPresent()) {
			// Update the existing order with the partial changes
			Order currentOrder = existingOrder.get();
			if (partialOrder.getProducts() != null) {
				currentOrder.setProducts(partialOrder.getProducts());
			}
			if (partialOrder.getTotalPrice() != 0) {
				currentOrder.setTotalPrice(partialOrder.getTotalPrice());
			}
			if (partialOrder.getCustomerName() != null) {
				currentOrder.setCustomerName(partialOrder.getCustomerName());
			}

			return true; // Patch successful
		} else {
			return false; // Order not found
		}
	}

}
